"use strict";(globalThis.webpackChunkkonifer_docs=globalThis.webpackChunkkonifer_docs||[]).push([[634],{2723:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Concepts/concepts-architecture","title":"Architecture","description":"Konifer leverages a dual-store architecture to manage assets efficiently.","source":"@site/docs/Concepts/architecture.md","sourceDirName":"Concepts","slug":"/Concepts/concepts-architecture","permalink":"/Concepts/concepts-architecture","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"id":"concepts-architecture","title":"Architecture","sidebar_label":"Architecture"},"sidebar":"docsSidebar","previous":{"title":"Getting Started","permalink":"/getting-started"},"next":{"title":"Path Configuration","permalink":"/Concepts/concepts-path-configuration"}}');var s=n(4848),i=n(8453);const o={sidebar_position:1,id:"concepts-architecture",title:"Architecture",sidebar_label:"Architecture"},a="Overview",l={},c=[{value:"Object Store",id:"object-store",level:2},{value:"In-memory",id:"in-memory",level:3},{value:"S3",id:"s3",level:3},{value:"Filesystem",id:"filesystem",level:3},{value:"Metadata Store",id:"metadata-store",level:2},{value:"Temporary Files",id:"temporary-files",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"overview",children:"Overview"})}),"\n",(0,s.jsx)(t.p,{children:"Konifer leverages a dual-store architecture to manage assets efficiently."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Object Store:"})," Persists the physical variant content (the binaries). Konifer supports AWS S3 and any S3-compatible provider."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Metadata Store:"})," Persists relational data, path hierarchies, tags, and labels. Currently, PostgreSQL is the supported engine."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Konifer avoids buffering the entire asset content in memory (not counting ",(0,s.jsx)(t.code,{children:"in-memory"})," object store) as much as\npossible to keep memory pressure low."]}),"\n",(0,s.jsx)(t.h2,{id:"object-store",children:"Object Store"}),"\n",(0,s.jsx)(t.p,{children:"The object store contains the binary asset content. Konifer supports three object store implementations:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"in-memory"}),"\n",(0,s.jsx)(t.li,{children:"S3 (including S3-compatible providers)"}),"\n",(0,s.jsx)(t.li,{children:"Filesystem"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:'Konifer treats the Object Store as a dumb "Key-Value" blob store.'}),"\n",(0,s.jsx)(t.h3,{id:"in-memory",children:"In-memory"}),"\n",(0,s.jsx)(t.p,{children:"For local development, unit testing, or trying out Konifer without infrastructure dependencies, you can enable in-memory storage implementations."}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["\u26a0\ufe0f Warning: Non-Production Use In-memory implementations are ",(0,s.jsx)(t.strong,{children:"ephemeral"}),". All data is lost when the container restarts.\nAdditionally, storage capacity is strictly limited by the JVM Heap size. Uploading large files in this mode may cause\n",(0,s.jsx)(t.code,{children:"OutOfMemoryError"})," crashes."]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"s3",children:"S3"}),"\n",(0,s.jsxs)(t.p,{children:["Konifer supports any S3 provider in addition to Amazon S3. This enables the usage of local storage options like ",(0,s.jsx)(t.a,{href:"https://www.min.io/",children:"MiniIO"}),"\nand the growing number of storage providers that provide S3-compatible APIs."]}),"\n",(0,s.jsx)(t.h3,{id:"filesystem",children:"Filesystem"}),"\n",(0,s.jsx)(t.p,{children:"By mounting a volume to the Docker container, Konifer can store assets on any filesystem."}),"\n",(0,s.jsx)(t.h2,{id:"metadata-store",children:"Metadata Store"}),"\n",(0,s.jsxs)(t.p,{children:["Konifer uses Postgres to manage asset metadata. This is done because relying on Object Store metadata is slow and inflexible.\nKonifer leverages the ",(0,s.jsx)(t.a,{href:"https://www.postgresql.org/docs/current/ltree.html",children:"Ltree"})," extension and is required to be enabled on the\nconfigured Postgres database."]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:"\u26a0\ufe0f Warning: The Ltree extension must be enabled within Postgres. Enabling extensions generally requires superuser privileges."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"temporary-files",children:"Temporary Files"}),"\n",(0,s.jsxs)(t.p,{children:["In order to keep memory pressure low when storing assets and generating variants, temporary files are used extensively.\nIt is recommended to leverage a local disk source like ",(0,s.jsx)(t.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html",children:"AWS Instance Storage"}),"\nand not external storage like ",(0,s.jsx)(t.a,{href:"https://aws.amazon.com/ebs/",children:"AWS EBS"})," for performant IO. Temporary data is deleted as soon as possible."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var r=n(6540);const s={},i=r.createContext(s);function o(e){const t=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);