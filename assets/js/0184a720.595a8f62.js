"use strict";(globalThis.webpackChunkkonifer_docs=globalThis.webpackChunkkonifer_docs||[]).push([[692],{7192:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Concepts/Assets/concepts-storing-assets","title":"Storing Assets","description":"When storing an asset, the content must be supplied as well as any optional metadata. The content can be supplied as:","source":"@site/docs/Concepts/Assets/storing-assets.md","sourceDirName":"Concepts/Assets","slug":"/Concepts/Assets/concepts-storing-assets","permalink":"/konifer-docs/Concepts/Assets/concepts-storing-assets","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"id":"concepts-storing-assets","title":"Storing Assets","sidebar_label":"Storing"},"sidebar":"docsSidebar","previous":{"title":"Introduction","permalink":"/konifer-docs/Concepts/Assets/concepts-assets"},"next":{"title":"Fetching","permalink":"/konifer-docs/Concepts/Assets/concepts-fetching-assets"}}');var a=s(4848),o=s(8453);const i={sidebar_position:2,id:"concepts-storing-assets",title:"Storing Assets",sidebar_label:"Storing"},r=void 0,l={},d=[{value:"Multipart upload",id:"multipart-upload",level:2},{value:"URL upload",id:"url-upload",level:2},{value:"Metadata",id:"metadata",level:2},{value:"Asset preprocessing",id:"asset-preprocessing",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"When storing an asset, the content must be supplied as well as any optional metadata. The content can be supplied as:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"a multi-part upload if you possess the binary asset content"}),"\n",(0,a.jsx)(n.li,{children:"a URL supplied alongside any metadata"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["When asset content is stored, it is referred to as the ",(0,a.jsx)(n.code,{children:"originalVariant"}),". When fetching asset metadata, ",(0,a.jsx)(n.code,{children:"isOriginalVariant"})," is\n",(0,a.jsx)(n.code,{children:"true"})," for the variant that represents the original supplied content."]}),"\n",(0,a.jsx)(n.h2,{id:"multipart-upload",children:"Multipart upload"}),"\n",(0,a.jsxs)(n.p,{children:["Binary asset data can be supplied using ",(0,a.jsx)(n.a,{href:"https://www.ietf.org/rfc/rfc2388.txt",children:"HTTP Multipart Form Data"}),". More information\nabout HTTP Multipart Forms ",(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Methods/POST",children:"here"}),". Your request\nshould look like this:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-http",children:'POST /assets/users/123 HTTP/1.1\nHost: your.api.com\nContent-Type: multipart/form-data; boundary=---------------------------974767299852498929531610575\n\n-----------------------------974767299852498929531610575\nContent-Disposition: form-data; name="metadata"\nContent-Type: application/json\n\n{\n  "alt": "Profile Picture",\n  "tags": ["headshot", "team"],\n  "labels": {\n    "department": "engineering"\n  }\n}\n-----------------------------974767299852498929531610575\nContent-Disposition: form-data; name="file"; filename="my-image.jpg"\nContent-Type: image/jpeg\n\n[Binary data of the image file...]\n-----------------------------974767299852498929531610575--\n'})}),"\n",(0,a.jsx)(n.p,{children:"Only one image and one form multipart can be supplied."}),"\n",(0,a.jsx)(n.h2,{id:"url-upload",children:"URL upload"}),"\n",(0,a.jsx)(n.p,{children:"If you wish to supply a URL referencing your asset, you must allow the subdomain in your configuration. By default,\nKonifer does not permit any HTTP subdomains. To allow Konifer to connect to an HTTP subdomain, supply them in your HOCON."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-hocon",children:'source {\n  url {\n    allowed-domains = [\n      "your-domain.com"\n    ]\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"If the domain is not allowed when uploading an asset, a 400 is returned."}),"\n",(0,a.jsx)(n.p,{children:"A request to store an asset using a URL looks like this (omitting all optional metadata):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "url": "your-domain.com/your-image.jpeg"\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"metadata",children:"Metadata"}),"\n",(0,a.jsxs)(n.p,{children:["Asset metadata is supplied as JSON. All metadata is optional, but fields such as ",(0,a.jsx)(n.code,{children:"alt"})," and LQIP(s) are useful for display purposes\nand are returned as headers when fetching asset content."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "alt": "The alt text for an image",\n  "labels": {\n    "label-key": "label-value",\n    "phone": "Android"\n  },\n  "tags": [ "cold", "verified" ]\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"asset-preprocessing",children:"Asset preprocessing"}),"\n",(0,a.jsx)(n.p,{children:"When you store an asset, you can transform the source content. Doing so means the original variant becomes the\nresult of your defined transformation. Any variant generated for this asset is generated from the original variant.\nKeep this in mind when defining any preprocessing. For example preprocessing an image down to 50x50 limits\nyour ability to create sharp, resized variants larger than 50x50."}),"\n",(0,a.jsx)(n.p,{children:"The following configuration converts the supplied asset content to an AVIF image format and set the width to 1024."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-hocon",children:'paths = [\n  {\n    path = "/users/**"\n    image {\n      preprocessing {\n        format = "image/avif"\n        w = 1024\n      }\n    }\n  }\n]\n'})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>r});var t=s(6540);const a={},o=t.createContext(a);function i(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);