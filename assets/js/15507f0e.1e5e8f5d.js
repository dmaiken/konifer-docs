"use strict";(globalThis.webpackChunkkonifer_docs=globalThis.webpackChunkkonifer_docs||[]).push([[208],{3046:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>o,frontMatter:()=>r,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"Reference/Assets API/asset-storing","title":"Storing Assets","description":"When you store an asset, the asset and it\'s metadata are stored in your object store and database, respectively.","source":"@site/docs/Reference/Assets API/store-assets.md","sourceDirName":"Reference/Assets API","slug":"/Reference/Assets API/asset-storing","permalink":"/konifer-docs/Reference/Assets API/asset-storing","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"id":"asset-storing","title":"Storing Assets","sidebar_label":"Store"},"sidebar":"docsSidebar","previous":{"title":"URL Signing","permalink":"/konifer-docs/Reference/url-signing"},"next":{"title":"Fetch","permalink":"/konifer-docs/Reference/Assets API/asset-fetching"}}');var d=s(4848),i=s(8453);const r={sidebar_position:2,id:"asset-storing",title:"Storing Assets",sidebar_label:"Store"},l=void 0,c={},h=[{value:"Multipart Upload",id:"multipart-upload",level:2},{value:"Metadata JSON structure",id:"metadata-json-structure",level:3},{value:"URL Source",id:"url-source",level:2},{value:"Store Asset Response",id:"store-asset-response",level:2},{value:"AssetVariant",id:"assetvariant",level:3},{value:"Attributes",id:"attributes",level:4},{value:"Format",id:"format",level:4}];function a(e){const t={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.p,{children:"When you store an asset, the asset and it's metadata are stored in your object store and database, respectively.\nThere are two ways to store an asset:"}),"\n",(0,d.jsxs)(t.ol,{children:["\n",(0,d.jsxs)(t.li,{children:[(0,d.jsx)(t.strong,{children:"Multipart Upload:"})," Use this when the asset content is available locally."]}),"\n",(0,d.jsxs)(t.li,{children:[(0,d.jsx)(t.strong,{children:"URL Source:"})," Use this when the asset content must be downloaded by Konifer from an external URL."]}),"\n"]}),"\n",(0,d.jsx)(t.p,{children:"The URL structure for both is:"}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-http",children:"POST /assets/{your/defined/path}\n"})}),"\n",(0,d.jsx)(t.p,{children:"The difference is how the content is supplied. Only one method is allowed per request."}),"\n",(0,d.jsx)(t.h2,{id:"multipart-upload",children:"Multipart Upload"}),"\n",(0,d.jsx)(t.p,{children:"A multipart upload lets you specify the asset content and metadata in the same request."}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Part Name"}),(0,d.jsx)(t.th,{children:"Content-Type"}),(0,d.jsx)(t.th,{children:"Purpose"}),(0,d.jsx)(t.th,{children:"Required?"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"metadata"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"application/json"})}),(0,d.jsx)(t.td,{children:"A JSON body containing custom, user-defined data about the asset"}),(0,d.jsxs)(t.td,{children:["Yes (but may be empty",(0,d.jsx)(t.code,{children:"{}"}),")"]})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"asset"})}),(0,d.jsxs)(t.td,{children:["Image MIME type (e.g., ",(0,d.jsx)(t.code,{children:"image/jpeg"}),")"]}),(0,d.jsx)(t.td,{children:"The raw binary content of the file being stored."}),(0,d.jsx)(t.td,{children:"Yes"})]})]})]}),"\n",(0,d.jsx)(t.h3,{id:"metadata-json-structure",children:"Metadata JSON structure"}),"\n",(0,d.jsxs)(t.p,{children:["The structure for the ",(0,d.jsx)(t.code,{children:"metadata"})," part is (no fields are required):"]}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-json",children:'{\n  "alt": "The alt text for an image",\n  "labels": {\n    "label-key": "label-value",\n    "phone": "Android"\n  },\n  "tags": [ "cold", "verified" ]\n}\n'})}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Field Name"}),(0,d.jsx)(t.th,{children:"Type"}),(0,d.jsx)(t.th,{children:"Description"}),(0,d.jsx)(t.th,{children:"Required"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"alt"})}),(0,d.jsx)(t.td,{children:"String"}),(0,d.jsx)(t.td,{children:"The supplied alt text of your asset"}),(0,d.jsx)(t.td,{children:"No"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"labels"})}),(0,d.jsx)(t.td,{children:"Object"}),(0,d.jsx)(t.td,{children:"Supplied key-value pairs associated with the asset"}),(0,d.jsx)(t.td,{children:"No"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"tags"})}),(0,d.jsx)(t.td,{children:"Array"}),(0,d.jsx)(t.td,{children:"Supplied attributes associated with the asset"}),(0,d.jsx)(t.td,{children:"No"})]})]})]}),"\n",(0,d.jsx)(t.h2,{id:"url-source",children:"URL Source"}),"\n",(0,d.jsxs)(t.p,{children:["Instead of supplying the file contents directly, you can specify a URL that Konifer downloads the asset content from.\nThe request is identical to the multipart ",(0,d.jsx)(t.code,{children:"metadata"}),", but you must add a ",(0,d.jsx)(t.code,{children:"url"})," to the request:"]}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-json",children:'{\n  "url": "https://yoururl.com/image.jpeg",\n  "alt": "The alt text for an image",\n  "labels": {\n    "label-key": "label-value",\n    "phone": "Android"\n  },\n  "tags": [ "cold", "verified" ]\n}\n'})}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Field Name"}),(0,d.jsx)(t.th,{children:"Type"}),(0,d.jsx)(t.th,{children:"Description"}),(0,d.jsx)(t.th,{children:"Required"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"alt"})}),(0,d.jsx)(t.td,{children:"String"}),(0,d.jsx)(t.td,{children:"The supplied alt text of your asset"}),(0,d.jsx)(t.td,{children:"No"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"labels"})}),(0,d.jsx)(t.td,{children:"Object"}),(0,d.jsx)(t.td,{children:"Supplied key-value pairs associated with the asset"}),(0,d.jsx)(t.td,{children:"No"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"tags"})}),(0,d.jsx)(t.td,{children:"Array"}),(0,d.jsx)(t.td,{children:"Supplied attributes associated with the asset"}),(0,d.jsx)(t.td,{children:"No"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"url"})}),(0,d.jsx)(t.td,{children:"String"}),(0,d.jsxs)(t.td,{children:["URL source of content. Domain must be allowed within ",(0,d.jsx)(t.code,{children:"allowed-domains"})," configuration"]}),(0,d.jsx)(t.td,{children:"Yes"})]})]})]}),"\n",(0,d.jsxs)(t.p,{children:["Since there is only JSON in the request, the ",(0,d.jsx)(t.code,{children:"Content-Type"})," is ",(0,d.jsx)(t.code,{children:"application/json"}),"."]}),"\n",(0,d.jsx)(t.h2,{id:"store-asset-response",children:"Store Asset Response"}),"\n",(0,d.jsxs)(t.p,{children:["Regardless of the upload method used, a successful storage request returns a ",(0,d.jsx)(t.code,{children:"201 Created"})," status and the following JSON response\nrepresenting the asset metadata."]}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-http",children:'HTTP/1.1 201 CREATED\nContent-Type: application/json\n\n{\n  "class": "image",\n  "alt": "The alt text for an image",\n  "entryId": 42,\n  "labels": {\n    "label-key": "label-value",\n    "phone": "Android"\n  },\n  "tags": [ "cold", "verified" ],\n  "source": "url", // or "upload" if using multipart upload\n  "sourceUrl": "https://yoururl.com/image.jpeg",\n  "variants": [\n    {\n      "isOriginalVariant": true,\n      "storeBucket": "assets",\n      "storeKey": "d905170f-defd-47e4-b606-d01993ba7b42",\n      "attributes": {\n        "height": 100,\n        "width": 200,\n        "format": "jpg"\n      },\n      "lqip": {\n        "blurhash": "BASE64",\n        "thumbhash": "BASE64"\n      }\n    }\n  ],\n  "createdAt": "2025-11-12T01:20:55"\n}\n'})}),"\n",(0,d.jsxs)(t.p,{children:["Additionally, a ",(0,d.jsx)(t.code,{children:"Location"})," header is returned containing an absolute URL to the asset's link return format."]}),"\n",(0,d.jsxs)(t.blockquote,{children:["\n",(0,d.jsx)(t.p,{children:"Note: the entryId query modifier is supplied so the URL is absolute and can be used for subsequent GET and PUT operations."}),"\n"]}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Field Name"}),(0,d.jsx)(t.th,{children:"Type"}),(0,d.jsx)(t.th,{children:"Description"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"class"})}),(0,d.jsx)(t.td,{children:"String"}),(0,d.jsxs)(t.td,{children:["The type of the asset, currently always ",(0,d.jsx)(t.code,{children:"image"})]})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"alt"})}),(0,d.jsx)(t.td,{children:"String"}),(0,d.jsx)(t.td,{children:"The supplied alt text of your asset"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"entryId"})}),(0,d.jsx)(t.td,{children:"Long"}),(0,d.jsx)(t.td,{children:"System-generated unique identifier of asset within path"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"labels"})}),(0,d.jsx)(t.td,{children:"Object"}),(0,d.jsx)(t.td,{children:"Supplied key-value pairs associated with the asset"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"tags"})}),(0,d.jsx)(t.td,{children:"Array"}),(0,d.jsx)(t.td,{children:"Supplied attributes associated with the asset"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"source"})}),(0,d.jsx)(t.td,{children:"String"}),(0,d.jsxs)(t.td,{children:["Either ",(0,d.jsx)(t.code,{children:"url"})," or ",(0,d.jsx)(t.code,{children:"upload"})," depending on how you provided asset content"]})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"sourceUrl"})}),(0,d.jsx)(t.td,{children:"String"}),(0,d.jsx)(t.td,{children:"If URL source was used, then this is the supplied URL"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"variants"})}),(0,d.jsx)(t.td,{children:"AssetVariant"}),(0,d.jsx)(t.td,{children:"Will only contain the original variant - the one supplied"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"createdAt"})}),(0,d.jsx)(t.td,{children:"ISO 8601"}),(0,d.jsx)(t.td,{children:"Date asset was stored"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"modifiedAt"})}),(0,d.jsx)(t.td,{children:"ISO 8601"}),(0,d.jsx)(t.td,{children:"Date asset was last modified (ignores variant generation)"})]})]})]}),"\n",(0,d.jsx)(t.h3,{id:"assetvariant",children:"AssetVariant"}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Field Name"}),(0,d.jsx)(t.th,{children:"Type"}),(0,d.jsx)(t.th,{children:"Description"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"isOriginalVariant"})}),(0,d.jsx)(t.td,{children:"Boolean"}),(0,d.jsx)(t.td,{children:"Whether the variant is the original variant. For store-asset response, this is true."})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"storeBucket"})}),(0,d.jsx)(t.td,{children:"String"}),(0,d.jsx)(t.td,{children:"The S3 bucket the asset is stored in - defined in path configuration"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"storeKey"})}),(0,d.jsx)(t.td,{children:"String"}),(0,d.jsx)(t.td,{children:"The key of the asset in the object store"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"attributes"})}),(0,d.jsx)(t.td,{children:"Attributes"}),(0,d.jsx)(t.td,{children:"Extracted attributes of the asset"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"transformation"})}),(0,d.jsx)(t.td,{children:"Transformation"}),(0,d.jsx)(t.td,{children:"Normalized original variant transformation - not returned for original variants"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"lqip"})}),(0,d.jsx)(t.td,{children:"LQIP"}),(0,d.jsx)(t.td,{children:"Low-Quality Image Placeholder (LQIP) values if enabled in path configuration"})]})]})]}),"\n",(0,d.jsx)(t.h4,{id:"attributes",children:"Attributes"}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Field Name"}),(0,d.jsx)(t.th,{children:"Type"}),(0,d.jsx)(t.th,{children:"Description"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"height"})}),(0,d.jsx)(t.td,{children:"Integer"}),(0,d.jsx)(t.td,{children:"Height of variant"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"width"})}),(0,d.jsx)(t.td,{children:"Integer"}),(0,d.jsx)(t.td,{children:"Width of variant"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"format"})}),(0,d.jsx)(t.td,{children:"Format"}),(0,d.jsx)(t.td,{children:"Format of variant"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"pageCount"})}),(0,d.jsx)(t.td,{children:"Integer"}),(0,d.jsx)(t.td,{children:"Number of pages in image (1 unless image is animated)"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"loop"})}),(0,d.jsx)(t.td,{children:"Integer"}),(0,d.jsx)(t.td,{children:"For mulit-paged images, specifies the amount of animated repitions. Defaults to 0; -1 is continuous looping"})]})]})]}),"\n",(0,d.jsx)(t.h4,{id:"format",children:"Format"}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{style:{textAlign:"left"},children:"Format"}),(0,d.jsx)(t.th,{style:{textAlign:"left"},children:"Name"}),(0,d.jsx)(t.th,{style:{textAlign:"left"},children:"File Extension"}),(0,d.jsx)(t.th,{style:{textAlign:"left"},children:"Content Type"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{style:{textAlign:"left"},children:(0,d.jsx)(t.code,{children:"png"})}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"PNG"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:".png"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"image/png"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{style:{textAlign:"left"},children:(0,d.jsx)(t.code,{children:"jpg"})}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"JPEG"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:".jpeg"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"image/jpeg"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{style:{textAlign:"left"},children:(0,d.jsx)(t.code,{children:"webp"})}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"WEBP"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:".webp"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"image/webp"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{style:{textAlign:"left"},children:(0,d.jsx)(t.code,{children:"avif"})}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"AVIF"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:".avif"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"image/avif"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{style:{textAlign:"left"},children:(0,d.jsx)(t.code,{children:"jxl"})}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"JPEG XL"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:".jxl"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"image/jxl"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{style:{textAlign:"left"},children:(0,d.jsx)(t.code,{children:"heic"})}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"HEIC"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:".heic"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"image/heic"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{style:{textAlign:"left"},children:(0,d.jsx)(t.code,{children:"gif"})}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"GIF"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:".gif"}),(0,d.jsx)(t.td,{style:{textAlign:"left"},children:"image/gif"})]})]})]})]})}function o(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,d.jsx)(t,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>l});var n=s(6540);const d={},i=n.createContext(d);function r(e){const t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:r(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);