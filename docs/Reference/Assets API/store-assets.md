---
sidebar_position: 2
id: asset-storing
title: Storing Assets
sidebar_label: "Store"
---
When you store an asset, the asset and it's metadata are stored in your object store and database, respectively.
There are two ways to store an asset:
1. **Multipart Upload:** Use this when the asset content is available locally.
2. **URL Source:** Use this when the asset content must be downloaded by Konifer from an external URL.

The URL structure for both is:
```http
POST /assets/{your/defined/path}
```
And the difference is how the content will be supplied. Both methods cannot be used at the same time.

## Multipart Upload
A multipart upload lets you specify the asset content and metadata in the same request.

| Part Name  | Content-Type                         | Purpose                                                          | Required? |
|------------|--------------------------------------|------------------------------------------------------------------|-----------|
| `metadata` | `application/json`                   | A JSON body containing custom, user-defined data about the asset | Yes       |
| `asset`    | Image MIME type (e.g., `image/jpeg`) | The raw binary content of the file being stored.                 | Yes       |

### Metadata JSON structure
The structure for the `metadata` part is:
```json
{
  "alt": "The alt text for an image",
  "labels": {
    "label-key": "label-value",
    "phone": "Android"
  },
  "tags": [ "cold", "verified" ]
}
```

## URL Source
Instead of supplying the file contents directly, you can specify a URL that Konifer will download the asset content from. 
The request is identical to the multipart `metadata`, but you will add a `url` to the request:
```json
{
  "url": "https://yoururl.com/image.jpeg",
  "alt": "The alt text for an image",
  "labels": {
    "label-key": "label-value",
    "phone": "Android"
  },
  "tags": [ "cold", "verified" ]
}
```
Additionally, since there is only JSON in the request, the `Content-Type` is `application/json`.

## Request Metadata Fields
| Field Name | Type   | Description                               | Required?                      |
|------------|--------|-------------------------------------------|--------------------------------|
| `url`      | String | The URL source of the asset content       | For URL upload source, **yes** |
| `alt`      | String | The alt text of your asset                | **No**                         |
| `labels`   | Object | Key-value pairs associated with the asset | **No**                         |
| `tags`     | Array  | Attributes associated with the asset      | **No**                         |


# Store Asset Response
Regardless of the upload method used, a successful storage request returns a **`201 Created`** status and the following JSON response
representing the asset metadata.
```json
{
  "class": "IMAGE",
  "alt": "The alt text for an image",
  "entryId": 42, // Unique identifier scoped to the path
  "labels": {
    "label-key": "label-value",
    "phone": "Android"
  },
  "tags": [ "cold", "verified" ],
  "source": "URL", // or UPLOAD if using multipart upload
  "sourceUrl": "https://yoururl.com/image.jpeg",
  "variants": [
    {
      "bucket": "assets", // Defined in configuration
      "storeKey": "d905170f-defd-47e4-b606-d01993ba7b42", // Generated by Konifer
      "attributes": {
        "height": 100,
        "width": 200,
        "format": "jpg"
      },
      "lqip": { // Empty if LQIPs are disabled
        "blurhash": "BASE64",
        "thumbhash": "BASE64"
      }
    }
  ],
  "createdAt": "2025-11-12T01:20:55" // ISO 8601
}
```
Additionally, a `Location` header is returned containing a URL to the asset's link return format.
> Note: the entryId query modifier is supplied so the URL is absolute and can be used for subsequent GET and PUT operations.

## Asset Metadata Response
| Field Name  | Type         | Description                                                          |
|-------------|--------------|----------------------------------------------------------------------|
| `class`     | String       | The type of the asset, currently always `IMAGE`                      |
| `alt`       | String       | The supplied alt text of your asset                                  |
| `entryId`   | Long         | System-generated unique identifier of asset within path              |
| `labels`    | Object       | Supplied key-value pairs associated with the asset                   |
| `tags`      | Array        | Supplied attributes associated with the asset                        |
| `source`    | String       | Either `URL` or `UPLOAD` depending on how you provided asset content |
| `sourceUrl` | String       | If URL source was used, then this is the supplied URL                |
| `variants`  | AssetVariant | Will only contain the original variant - the one supplied            |
| `createdAt` | ISO 8601     | Date asset was stored                                                |

### AssetVariant
| Field Name        | Type            | Description                                                                  |
|-------------------|-----------------|------------------------------------------------------------------------------|
| `bucket`          | String          | The S3 bucket the asset is stored in - defined in path configuration         |
| `storeKey`        | String          | The key of the asset in the object store                                     |
| `imageAttributes` | ImageAttributes | Extracted attributes of the asset.                                           |
| `lqip`            | LQIP            | Low-Quality Image Placeholder (LQIP) values if enabled in path configuration |
